# sample-container-runtime-helloworld
いろいろな言語をコンテナで立ち上げてHelloWorldさせるサンプル

Dockerをインストールし，スクリプトファイル(*.sh)を実行すると，様々な言語のHelloWorldが実行されます。

### 仕組み

各スクリプトファイルでは，dockerコマンドを使って，実行対象のソースファイルのみをコンテナから見えるようにマウントして，
各言語の実行コマンドを使って実行しています。実行すると，実行コマンドを含むコンテナイメージ(ローカルになければ自動的にダウンロードされる)からコンテナが作成され，そのコンテナ内で実行が行われます。以下は，Pythonの例です。

```
#!/bin/bash
docker run \
  --rm \
  -v $(pwd)/hello_world.py:/work/hello_world.py \
  -w /work python:3 \
  python3 hello_world.py
```

* --rm オプションは，実行に使用したコンテナを，実行後に削除するオプションです。これを忘れると，ゴミが溜まっていきます。
* -v オプションは，ファイルやディレクトリをコンテナ内から見えるようにする(マウント)オプションです。
* -w オプションは，実行時の作業ディレクトリ(カレントディレクトリ)を指定するオプションです。コンテナ内のパスを指定します。
* python3以降は，コンテナ内で実行するコマンドです。言語によりコマンドや引数が異なります。

以下に，Javaの例も載せておきます。

```
#!/bin/bash
docker run \
  --rm \
  -v $(pwd)/HelloWorld.java:/work/HelloWorld.java \
  -w /work adoptopenjdk:11 \
  bash -c "javac HelloWorld.java && java -cp . HelloWorld"
```

Javaはコンパイル言語なので，コンパイルと実行の2つの処理を行っています。そのため，実行コマンドとしては`bash -c`を指定し，
その中でjavacとjavaを順番に実行しています。jshellを使えば，Javaでもインタプリタ言語のように実行できます。詳細はjshellの例を参照してください。


### 留意点
実際にシステムに組み込んで使う場合，以下の点に留意してください。

* マウントするファイル(-v)は最小限にしてください。例えばディスク全体をマウントしてしまうと，実行するプログラムからシステムを書き換えることが可能になってしまいます。
* プログラムから起動する場合，一定時間経過後に終了していなければ必ずプロセスを殺すように実装してください。無限ループするプログラムなどが実行されてしまうと，システムが重くなったりクラウドサーバの料金が跳ね上がったりします。

